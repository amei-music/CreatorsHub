<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript">
        var param = {
            // SPEAKS server address (default)
            server: "localhost:16080"
        };

        // get query parameters
        if(window.location.search.length > 1){
            let query = window.location.search.substring(1);
            let args = query.split('&');
            for(let arg of args){
                let p = arg.split('=');
                param[p[0]] = p[1];
            }
        }

        // append <script> element to load 'socket.io.js' from server
        var server_url = "http://" + param.server + "/socket.io/socket.io.js";
        var s = document.createElement("script");
        s.src = server_url;
        document.head.appendChild(s);
    </script>
</head>
<body>
    <script src="./connection_test.js"></script>
    <script type="text/javascript">
        window.onload = function(){
            ctrl.init(param.server);
        }
    </script>
    <!--------------------------------------------------------->
    <h1>SPEAKS connection test</h1>
    <p>Usage: index.html[?server=host:port]
    <p>If server is not specified, 'localhost:16080' is used as default server.
    <hr>
    <!--------------------------------------------------------->
    <p>Parameter:
    <div id="server_param"></div>
    <script type="text/javascript">
        // display query parameters
        var div = document.getElementById("server_param");
        for(var i in param){
            div.innerHTML += i + "=" + param[i] + "<br>";
        }
    </script>
    <hr>
    <!-- test functions -->
    <!--------------------------------------------------------->
    <button onclick="ctrl.join_as_wsjson();">Create JSON Client</button><br>
    <button onclick="ctrl.exit_wsjson();">Remove JSON Client</button><br>
    <button onclick="ctrl.sendNoteOnAsJSON();">Send NoteOn as JSON</button>
    <button onclick="ctrl.sendPeriodicStart();">Send Periodic</button>
    <button onclick="ctrl.sendPeriodicStop();">Stop</button>
    <hr>
    <!--------------------------------------------------------->
    <button onclick="ctrl.disconnectUserClients();">Disconnect User Clients</button><br>
    <button onclick="ctrl.removeUserClients();">Remove User Clients</button><br>
    <button onclick="ctrl.addUserClients();">Add User Clients</button><br>
    <button onclick="ctrl.connectUserClients();">Connect User Clients</button><br>
    <hr>
    <!--------------------------------------------------------->
    <!--
    <button onclick="ctrl.test_modules();">Test Modules</button>
    <hr>
    -->
    <!--------------------------------------------------------->
    <div id="status"></div>
    <!--------------------------------------------------------->
</body>